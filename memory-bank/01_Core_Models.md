# 核心模型與物件導向設計 (Core Models & OOP Design)

本文件定義了遊戲世界中最核心的數據模型，以及我們實現高擴充性物件的物件導向設計策略。

## 1. 靈魂/肉體分離 (Soul/Body Decoupling)

為提供最大的靈活性（如附身、觀察者模式），我們將玩家連線與遊戲角色分離。

- **`PlayerConnection` (The Soul)**: 代表玩家的網路連線。負責管理 WebSocket、處理原始指令、並持有對其當前附身的 `Character` 的引用。
    
- **`Character` (The Body)**: `LivingObject` 的一種，是遊戲世界中的實際存在。擁有屬性、物品欄、位置等遊戲內狀態。NPC 也是 `LivingObject`。
    

## 2. 物件ID系統 (Object ID System)

每個 `GameObject` 都有兩個ID來定義其身份。

- **`blueprintId` (藍圖ID)**: 代表物件的「類型」或「模板」。由開發者在類別中以 `static readonly` 方式硬編碼定義，穩定不變。範例: `'item:weapon:longsword'`
    
- **`instanceId` (實例ID)**: 代表一個「具體的、唯一的實例」。由系統在物件實例被創建時，使用 `uuid` 自動生成。範例: `'a1b2c3d4-...'`
    

## 3. 設計策略：組合優於繼承 (Composition Over Inheritance)

為了建立高擴充性與模組化的物件，我們避免使用複雜的繼承樹。取而代之，我們遵循「組合優於繼承」的原則，並策略性地混用**組合模式**與 **Mixin 模式**。

### 3.1 Mixin 模式: 賦予物件「能力」 (is-capable-of)

- **核心哲學**: 將可重用的「能力包」直接混入（mix-in）物件的定義中，讓物件本身「學會」新技能。
    
- **適用場景**: 用於定義**基礎、共通的核心能力**。
    

### 3.2 組合模式: 讓物件「擁有」系統 (has-a)

- **核心哲學**: 物件透過持有一個或多個獨立的「元件」物件，將複雜的職責**委派 (delegate)** 給這些元件。
    
- **適用場景**: 用於集成**複雜、獨立的行為系統**。
    

### 3.3 最終策略：策略性混用

1. **使用 Mixin** 來組裝出一個物件的**基礎能力**。
    
2. **使用組合模式** 來為物件掛載**高階、複雜的功能模組**。